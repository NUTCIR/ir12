<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>雇主滿意度調查</title>
    <link rel="stylesheet" href="index.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
    <link rel="stylesheet" href="../css/top.css">
    <script type="module" src="../js/scroll.js"></script>
    <script nomodule src="../js/scroll.js"></script>
    <script src="../js/top.js"></script>
    <script src="../js/chartlabel.js"></script>
</head>

<body>
    <!--回頂部按鈕-->
    <button id="topBtn" onclick="topFunction(40)" title="GoTop">Top</button>
    <div class="container">
        <h1>108學年度雇主滿意度調查</h1>
        <div class="col-12">
            <ul class="nav nav-tabs" id="NAV">
                <li class="nav-item">
                    <a class="nav-link active" onclick="insert(whole_result)">全校</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="insert(bussiness_result)">商學院</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="insert(design_result)">設計學院</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="insert(philology_result)">語文學院</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="insert(Information_result)">資訊與流通學院</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="insert(health_result)">中護健康學院</a>
                </li>
            </ul>
        </div>
        <div class="container">
        </div>
    </div>
</body>
<script>
    $(function () {
        $('#NAV a').click(function (e) {
            e.preventDefault();
            $(this).tab('show');
        })
    }) 
</script>
<script>
    content = {
        "一、請您依照本校畢業生在貴公司的表現予以評價": {
            "(一)專業知能方面": [
                {
                    "id": '01',
                    "Question": '1.具備的專業知識用於工作需求上',
                },
                {
                    "id": '02',
                    "Question": '2.能將專業技能用於工作實務上',
                }

            ],
            "(二)工作表現方面": [
                {
                    "id": '03',
                    "Question": '3.外語能力',
                }, {
                    "id": '04',
                    "Question": '4.工作效率',
                }, {
                    "id": '05',
                    "Question": '5.責任感',
                }, {
                    "id": '06',
                    "Question": '6.敬業的工作態度',
                }, {
                    "id": '07',
                    "Question": '7.工作上解決問題能力',
                }, {
                    "id": '08',
                    "Question": '8.工作上團隊合作能力',
                }, {
                    "id": '09',
                    "Question": '9.與主管、同仁及下屬的溝通能力',
                }, {
                    "id": '10',
                    "Question": '10.可接受批評且主動改進之態度',
                }, {
                    "id": '11',
                    "Question": '11.國際化視野',
                }, {
                    "id": '12',
                    "Question": '12.創意與創新能力表現',
                }, {
                    "id": '13',
                    "Question": '13.抗壓性',
                }, {
                    "id": '14',
                    "Question": '14.情緒管理能力',
                }, {
                    "id": '15',
                    "Question": '15.參與學習的意願',
                }]
        },
        "二、給予本校的回饋": [
            {
                "id": '16',
                "Question": '16.貴公司再任用本校畢業生的意願為何',
                "Answer": ['非常願意', '願意', '普通', '不願意', '非常不願意'],
            },
            {
                "id": '17',
                "Question": '17.為提高本校畢業生符合職場需求，建議學校待加強事項',
                "Answer": ['針對職場調整課程設計', '增加至業界實習機會', '強化實務的應用', '協助學生瞭解及規劃職涯方向', '專業證照取得', '加強外語能力', '其他'],
            }, {
                "id": '18',
                "Question": '18.在聘用新進人員時，徵才的考量因素有哪些',
                "Answer": ['畢業成績', '實務經驗', '外語能力', '人際關係', '社團經驗', '職場倫理', '溝通能力', '電腦能力', '儀容談吐', '打工經驗', '工作態度、配合度', '專業技能、競賽得獎經歷',
                    '未來發展潛力', '其他'],
            }, {
                "id": '19',
                "Question": '19.貴公司有無提供大專校院學生實習機會',
                "Answer": ['有', '沒有'],
            }, {
                "id": '20',
                "Question": '20.貴公司是否願意提供本校學生實習機會',
                "Answer": ['願意', '目前尚未規劃'],
            },
        ]
    }
    var whole_result = [
        [86, 91, 18, 0, 0],
        [85, 93, 17, 0, 0],
        [49, 82, 58, 5, 1],
        [100, 75, 20, 0, 0],
        [99, 88, 8, 0, 0],
        [101, 86, 8, 1, 0],
        [90, 73, 32, 0, 0],
        [99, 81, 15, 0, 0],
        [93, 86, 16, 10, 0],
        [91, 90, 14, 0, 0],
        [57, 89, 46, 3, 0],
        [73, 87, 33, 2, 0],
        [91, 84, 19, 1, 0],
        [84, 95, 15, 1, 0],
        [98, 87, 9, 1, 0],
        [122, 65, 8],
        [77, 109, 129, 64, 71, 69, 4],
        [8, 107, 49, 74, 20, 85, 147, 34, 65, 12, 150, 42, 62, 0],
        [148, 47],
        [144, 51]
    ]
    var bussiness_result = [
        [59, 66, 15, 0, 0],
        [62, 66, 12, 0, 0],
        [28, 65, 42, 4, 1],
        [71, 52, 17, 0, 0],
        [66, 67, 7, 0, 0],
        [69, 64, 7, 0, 0],
        [63, 52, 25, 0, 0],
        [70, 59, 11, 0, 0],
        [66, 62, 12, 0, 0],
        [61, 69, 10, 0, 0],
        [34, 66, 37, 3, 0],
        [45, 68, 25, 2, 0],
        [63, 64, 12, 1, 0],
        [57, 69, 13, 1, 0],
        [68, 64, 7, 1, 0],
        [83, 51, 6, 0, 0],
        [50, 81, 90, 45, 61, 55, 4],
        [5, 73, 40, 55, 17, 61, 102, 25, 54, 5, 112, 32, 47, 0],
        [109, 31],
        [105, 35]
    ]
    var design_result = [
        [19, 9, 0, 0, 0],
        [19, 9, 0, 0, 0],
        [15, 5, 7, 1, 0],
        [21, 6, 1, 0, 0],
        [21, 7, 0, 0, 0],
        [20, 8, 0, 0, 0],
        [19, 8, 1, 0, 0],
        [18, 10, 0, 0, 0],
        [19, 9, 0, 0, 0],
        [20, 7, 1, 0, 0],
        [16, 9, 3, 0, 0],
        [18, 8, 2, 0, 0],
        [20, 7, 1, 0, 0],
        [20, 8, 0, 0, 0],
        [19, 8, 1, 0, 0],
        [21, 7, 0, 0, 0],
        [11, 14, 16, 10, 3, 6, 0],
        [2, 19, 1, 5, 0, 10, 20, 6, 4, 6, 17, 9, 5, 0],
        [22, 6],
        [21, 7]
    ]
    var philology_result = [
        [1, 7, 2, 0, 0],
        [1, 7, 2, 0, 0],
        [3, 4, 3, 0, 0],
        [2, 7, 1, 0, 0],
        [3, 6, 1, 0, 0],
        [4, 5, 1, 0, 0],
        [1, 7, 2, 0, 0],
        [3, 5, 2, 0, 0],
        [1, 7, 2, 0, 0],
        [2, 7, 1, 0, 0],
        [1, 7, 2, 0, 0],
        [2, 6, 2, 0, 0],
        [4, 4, 2, 0, 0],
        [4, 5, 1, 0, 0],
        [5, 4, 1, 0, 0],
        [7, 2, 1, 0, 0],
        [5, 6, 9, 6, 3, 3, 0],
        [0, 5, 6, 3, 0, 4, 9, 2, 2, 1, 8, 0, 4, 0],
        [7, 3],
        [8, 2]
    ]
    var Information_result = [
        [6, 3, 0, 0, 0],
        [6, 3, 0, 0, 0],
        [3, 3, 3, 0, 0],
        [5, 4, 0, 0, 0],
        [8, 1, 0, 0, 0],
        [7, 2, 0, 0, 0],
        [6, 2, 1, 0, 0],
        [7, 2, 0, 0, 0],
        [5, 3, 1, 0, 0],
        [5, 3, 1, 0, 0],
        [6, 1, 2, 0, 0],
        [6, 1, 2, 0, 0],
        [4, 5, 0, 0, 0],
        [3, 6, 0, 0, 0],
        [5, 4, 0, 0, 0],
        [7, 2, 0, 0, 0],
        [6, 5, 7, 2, 1, 3, 0],
        [0, 3, 1, 6, 3, 5, 8, 1, 2, 0, 8, 1, 5, 0],
        [5, 4],
        [5, 4]
    ]
    var health_result = [
        [1, 6, 1, 0, 0],
        [1, 6, 1, 0, 0],
        [0, 5, 3, 0, 0],
        [1, 6, 1, 0, 0],
        [1, 7, 0, 0, 0],
        [1, 7, 0, 0, 0],
        [1, 4, 3, 0, 0],
        [1, 5, 2, 0, 0],
        [2, 5, 1, 0, 0],
        [3, 4, 1, 0, 0],
        [0, 6, 2, 0, 0],
        [2, 4, 2, 0, 0],
        [0, 4, 4, 0, 0],
        [0, 7, 1, 0, 0],
        [1, 7, 0, 0, 0],
        [4, 3, 1, 0, 0],
        [5, 3, 7, 1, 3, 2, 0],
        [1, 6, 1, 4, 0, 5, 8, 0, 3, 0, 5, 0, 1, 1],
        [5, 3],
        [5, 3]
    ]
    window.chartColors = {
        red: 'rgb(255, 99, 132)',
        orange: 'rgb(255, 159, 64)',
        yellow: 'rgb(255, 205, 86)',
        green: 'rgb(75, 192, 192)',
        blue: 'rgb(54, 162, 235)',
        purple: 'rgb(153, 102, 255)',
        grey: 'rgb(201, 203, 207)'
    };

    var container = document.getElementsByClassName('container')[1]
    container.innerHTML = ''
    function insert(select = whole_result) {
        var container = document.getElementsByClassName('container')[1]
        container.innerHTML = ''
        var div = document.createElement("div")
        div.className = "col-12"
        var title = document.createElement("h2")
        var level1 = Object.keys(content)[0]
        title_text = document.createTextNode(level1)
        title.appendChild(title_text)
        div.appendChild(title)
        container.appendChild(div)
        for (var i in content[level1]) {
            var div_1 = document.createElement("div")
            div_1.className = "col-12"
            var title = document.createElement("h3")
            title_text = document.createTextNode(i)
            title.appendChild(title_text)
            div_1.appendChild(title)
            container.appendChild(div_1)
            for (var j = 0; j < content[level1][i].length; j++) {
                var div_2 = document.createElement("div")
                div_2.className = "col-12"
                var question = document.createElement("p")
                question_text = document.createTextNode(content[level1][i][j]["Question"])
                question.appendChild(question_text)
                div_2.appendChild(question)
                var canvas = document.createElement("canvas")
                canvas.id = content[level1][i][j]["id"]
                container.appendChild(div_2)
                container.appendChild(canvas)
                draw(content[level1][i][j]["id"], null, select[parseInt(content[level1][i][j]["id"]) - 1], content[level1][i][j]["Question"])

            }
        }
        var div_3 = document.createElement("div")
        div_3.className = "col-12"
        var title = document.createElement("h2")
        var level2 = Object.keys(content)[1]
        title_text = document.createTextNode(level2)
        title.appendChild(title_text)
        div_3.appendChild(title)
        container.appendChild(div_3)
        for (var j = 0; j < content[level2].length; j++) {
            var div_2 = document.createElement("div")
            div_2.className = "col-12"
            var question = document.createElement("p")
            question_text = document.createTextNode(content[level2][j]["Question"])
            question.appendChild(question_text)
            div_2.appendChild(question)
            var canvas = document.createElement("canvas")
            canvas.id = content[level2][j]["id"]
            container.appendChild(div_2)
            container.appendChild(canvas)
            draw(content[level2][j]["id"], content[level2][j]["Answer"], select[parseInt(content[level2][j]["id"]) - 1], content[level2][j]["Question"])

        }
    }

    function draw(id, Answer, result, Question) {
        if (Answer == null) {
            Answer = [
                '非常滿意',
                '滿意',
                '普通',
                '不滿意',
                '非常不滿意']
        }
        var barChartData = {
            labels: Answer,
            datasets: [{
                label: Question,
                backgroundColor: window.chartColors.green,
                data: result
            }]

        };
        var ctx = document.getElementById(id).getContext('2d');
        window.myBar = new Chart(ctx, {
            type: 'bar',
            data: barChartData,
            options: {
                legend: {
                    lebels: {
                        FontColor: 'red',
                    },
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                },
                responsive: true,
                scales: {
                    xAxes: [{
                        ticks: {
                            fontSize: 18
                        },
                        stacked: true,
                    }],
                    yAxes: [{
                        ticks: {
                            callback: function (value, index, values) {
                                return value + '人';
                            },
                            fontSize: 18
                        },
                        stacked: true,
                    }],
                },
                plugins: {
                    datalabels: {
                        align: 'end',
                        anchor: 'end',
                        offset: '1'
                    }
                }
            },
            plugins: [{
                beforeInit: function (chart) {
                    chart.data.labels.forEach(function (e, i, a) {
                        if (/\n/.test(e)) {
                            a[i] = e.split(/\n/);
                        }
                    });
                }
            }]
        });
    };

    window.onload = function () {
        insert();
    };

</script>

</html>